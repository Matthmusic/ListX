# üöÄ REFONTE LISTX - Syst√®me de Templates

## üìå Vision du projet

Transformer ListX d'une application √† champs fixes vers un syst√®me flexible bas√© sur des templates configurables, permettant de :
- D√©finir des champs personnalis√©s (nom, type, ordre, obligation)
- Sauvegarder et r√©utiliser des configurations (templates)
- Partager des templates entre membres d'√©quipe
- Adapter automatiquement les exports PDF/Excel

---

## üéØ Objectifs

### Objectifs fonctionnels
- ‚úÖ Cr√©er/√©diter/supprimer des templates
- ‚úÖ Configurer les champs : nom, type, ordre, obligation
- ‚úÖ Limite de 12 champs par template (pour v1)
- ‚úÖ Import/export de templates (JSON)
- ‚úÖ Import/export de projets complets (template + donn√©es)
- ‚úÖ Formulaire de saisie dynamique bas√© sur le template actif
- ‚úÖ Exports PDF/Excel adaptatifs

### Objectifs techniques
- üìÅ Stockage : Fichiers JSON locaux via Electron
- üîÑ Pas de migration des donn√©es existantes (v1)
- üß© Types de champs de base : text, select, number, date
- üé® Interface intuitive avec wizard optionnel

---

## üìä D√©cisions d'architecture

### 1. Stockage des donn√©es

**Templates** : `AppData/ListX/templates/`
```json
{
  "id": "uuid-v4",
  "nom": "Template BET Structure",
  "description": "Template pour projets de structure",
  "version": "1.0.0",
  "dateCreation": "2025-10-27T10:30:00Z",
  "dateModification": "2025-10-27T10:30:00Z",
  "champs": [
    {
      "id": "field_uuid",
      "nom": "Affaire",
      "type": "text",
      "obligatoire": true,
      "ordre": 1,
      "visible": true,
      "inclureDansNom": true,
      "cleDeCat√©gorie": false,
      "largeurColonne": 15,
      "placeholder": "Nom de l'affaire",
      "options": null
    }
  ],
  "exportConfig": {
    "afficherCategories": false
  }
}
```

**Projets** : `AppData/ListX/projets/`
```json
{
  "id": "uuid-v4",
  "nom": "Projet H√¥pital Saint-Jean",
  "templateId": "uuid-template",
  "templateSnapshot": { /* copie du template */ },
  "dateCreation": "2025-10-27T10:30:00Z",
  "dateModification": "2025-10-27T11:45:00Z",
  "documents": [
    {
      "id": 12345,
      "valeurs": {
        "field_uuid": "HSJ",
        "field_uuid2": "PRO",
        // ...
      },
      "nomComplet": "HSJ_PRO_...",
      "numero": "1.01"
    }
  ],
  "exportConfig": {
    "nomProjet": "H√¥pital Saint-Jean",
    "nomListe": "Plans Structure",
    "logoClient": "base64...",
    "logoBE": "base64...",
    "date": "2025-10-27",
    "indice": "A"
  }
}
```

### 2. Types de champs support√©s (v1)

| Type | Description | Validation | Exemple |
|------|-------------|------------|---------|
| `text` | Texte libre | Longueur max 100 | "Affaire", "Zone" |
| `select` | Liste d√©roulante | Options d√©finies | "Phase", "Nature" |
| `number` | Num√©rique | Min/Max optionnels | "Lot" (si num√©rique) |
| `date` | S√©lecteur de date | Format ISO | "Date √©mission" |

### 3. Compatibilit√© et migration

**v1** : Pas de migration automatique
- Les anciens projets restent accessibles en "mode legacy"
- Option manuelle de conversion vers nouveau format (v2)

**Strat√©gie de compatibilit√©** :
- Template snapshot dans chaque projet (ind√©pendance)
- Versionning des templates (v1.0.0)
- D√©tection de format au chargement

---

## üèóÔ∏è Plan de d√©veloppement

### **SPRINT 1 : Infrastructure de base** ‚úÖ TERMIN√â

#### Objectifs
- [x] Document de suivi cr√©√©
- [x] Structure de donn√©es templates d√©finie
- [x] API Electron pour gestion fichiers (IPC)
- [x] Fonctions CRUD templates (Create, Read, Update, Delete)
- [x] Syst√®me de stockage JSON persistant
- [x] Tests de lecture/√©criture

#### Livrables ‚úÖ
- ‚úÖ `src/models/Template.js` : Classe Template avec validation
- ‚úÖ `src/models/Project.js` : Classe Project
- ‚úÖ `src/models/Field.js` : Classe Field
- ‚úÖ `src/utils/validation.js` : Fonctions de validation
- ‚úÖ `src/utils/uuid.js` : G√©n√©rateur d'UUID
- ‚úÖ `electron/templateManager.js` : Gestionnaire de fichiers templates
- ‚úÖ `electron/projectManager.js` : Gestionnaire de fichiers projets
- ‚úÖ `electron/main.js` : IPC handlers ajout√©s (12 endpoints)
- ‚úÖ `electron/preload.js` : API expos√©e (templates + projects)
- ‚úÖ `test-infrastructure.html` : Suite de tests interactifs
- ‚úÖ `src/templates/defaults/` : Templates par d√©faut (BET Structure, Simple)

#### Fichiers √† cr√©er/modifier
```
listx/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Template.js          [NOUVEAU]
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Project.js           [NOUVEAU]
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Field.js             [NOUVEAU]
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ validation.js        [NOUVEAU]
‚îÇ       ‚îî‚îÄ‚îÄ uuid.js              [NOUVEAU]
‚îú‚îÄ‚îÄ electron/
‚îÇ   ‚îú‚îÄ‚îÄ templateManager.js       [NOUVEAU]
‚îÇ   ‚îú‚îÄ‚îÄ projectManager.js        [NOUVEAU]
‚îÇ   ‚îú‚îÄ‚îÄ main.js                  [MODIFIER]
‚îÇ   ‚îî‚îÄ‚îÄ preload.js               [MODIFIER]
‚îî‚îÄ‚îÄ REFONTE_TEMPLATES.md         [CE FICHIER]
```

---

### **SPRINT 2 : √âditeur de templates** ‚è≥ Estimation : 2-3 jours

#### Objectifs
- [ ] √âcran de s√©lection de template
- [ ] √âcran d'√©dition de template
- [ ] Gestion des champs (ajouter/supprimer/r√©organiser)
- [ ] Configuration des propri√©t√©s de champs
- [ ] Drag & drop pour r√©organisation
- [ ] Pr√©visualisation du formulaire
- [ ] Sauvegarde/chargement de templates

#### Livrables
- `src/components/TemplateSelector.jsx`
- `src/components/TemplateEditor.jsx`
- `src/components/FieldEditor.jsx`
- `src/components/FieldList.jsx`

#### Maquette UI
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ListX - √âdition Template                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Nom : [BET Structure_______________]           ‚îÇ
‚îÇ Description : [____________________]           ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ Champs configur√©s (3/12) :                    ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ ‚îÇ ‚â° Affaire        [Text ‚ñº] ‚òë Obligatoire ‚îÇ  ‚îÇ
‚îÇ ‚îÇ   Placeholder: [Nom de l'affaire]        ‚îÇ  ‚îÇ
‚îÇ ‚îÇ   Largeur: [15] [üóëÔ∏è]                     ‚îÇ  ‚îÇ
‚îÇ ‚îÇ                                           ‚îÇ  ‚îÇ
‚îÇ ‚îÇ ‚â° Phase          [Select ‚ñº] ‚òë Oblig.    ‚îÇ  ‚îÇ
‚îÇ ‚îÇ   Options: DIAG,APS,APD,AVP,PRO...       ‚îÇ  ‚îÇ
‚îÇ ‚îÇ   Largeur: [10] [üóëÔ∏è]                     ‚îÇ  ‚îÇ
‚îÇ ‚îÇ                                           ‚îÇ  ‚îÇ
‚îÇ ‚îÇ ‚â° Lot            [Text ‚ñº] ‚òê Oblig.      ‚îÇ  ‚îÇ
‚îÇ ‚îÇ   Placeholder: [Num√©ro de lot]           ‚îÇ  ‚îÇ
‚îÇ ‚îÇ   Largeur: [10] [üóëÔ∏è]                     ‚îÇ  ‚îÇ
‚îÇ ‚îÇ                                           ‚îÇ  ‚îÇ
‚îÇ ‚îÇ [+ Ajouter un champ]                     ‚îÇ  ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                                ‚îÇ
‚îÇ [Pr√©visualiser] [Enregistrer] [Annuler]       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### **SPRINT 3 : Formulaire dynamique** ‚è≥ Estimation : 2 jours

#### Objectifs
- [ ] G√©n√©ration dynamique du formulaire de saisie
- [ ] Validation bas√©e sur le template actif
- [ ] Gestion des valeurs par champ dynamique
- [ ] Conservation de la logique m√©tier (num√©rotation, etc.)
- [ ] Tests de saisie avec diff√©rents templates

#### Livrables
- `src/components/DynamicForm.jsx`
- `src/hooks/useTemplate.js`
- `src/hooks/useProject.js`
- Refactorisation de `DocumentListingApp.jsx`

#### Architecture
```javascript
// Avant (√©tat statique)
const [affaire, setAffaire] = useState('');
const [phase, setPhase] = useState('');
// ...

// Apr√®s (√©tat dynamique)
const [valeurs, setValeurs] = useState({}); // { field_uuid: 'valeur' }
const { template } = useTemplate();

// Acc√®s aux valeurs
valeurs[template.champs[0].id] // Au lieu de 'affaire'
```

---

### **SPRINT 4 : Exports dynamiques** ‚è≥ Estimation : 2-3 jours

#### Objectifs
- [ ] Adaptation du g√©n√©rateur PDF
  - Colonnes dynamiques bas√©es sur template
  - Largeurs de colonnes configurables
  - Ordre des champs respect√©
- [ ] Adaptation du g√©n√©rateur Excel
  - Headers dynamiques
  - Largeurs adaptatives
  - Formules optionnelles
- [ ] Tests d'export avec templates vari√©s
- [ ] Gestion des champs vides/cach√©s

#### Livrables
- `src/utils/pdfGenerator.js` (refactoris√©)
- `src/utils/excelGenerator.js` (refactoris√©)
- Tests d'export

#### D√©fis techniques
```javascript
// G√©n√©ration dynamique des colonnes PDF
const columns = template.champs
  .filter(c => c.visible)
  .sort((a, b) => a.ordre - b.ordre)
  .map(champ => ({
    header: champ.nom,
    dataKey: champ.id,
    width: champ.largeurColonne
  }));

// Mapping des donn√©es
const rows = documents.map(doc => {
  const row = {};
  template.champs.forEach(champ => {
    row[champ.id] = doc.valeurs[champ.id] || '';
  });
  return row;
});
```

---

### **SPRINT 5 : Fonctions avanc√©es** ‚è≥ Estimation : 1-2 jours

#### Objectifs
- [ ] Import/export de templates (JSON)
- [ ] Import/export de projets complets (template + donn√©es)
- [ ] Duplication de templates
- [ ] Templates par d√©faut pr√©-configur√©s
- [ ] Wizard de premier lancement (optionnel)
- [ ] Documentation utilisateur

#### Livrables
- `src/components/ImportExport.jsx`
- `src/templates/defaults/` (templates par d√©faut)
- `GUIDE_UTILISATEUR.md`

#### Templates par d√©faut inclus
1. **Template BET Structure** : Affaire, Phase, Lot, √âmetteur, Nature, N¬∞ Doc, Format, Indice, Nom
2. **Template Simple** : Affaire, Phase, Nature, Format, Indice, Nom
3. **Template Architecture** : Affaire, Phase, √âtage, Zone, Nature, Format, Indice, Nom
4. **Template Vierge** : 3 champs minimaux (Affaire, Nature, Nom)

---

## üé® Wizard de premier lancement (proposition)

### √âtape 1 : Bienvenue
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Bienvenue dans ListX 2.0 !            ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  Cette nouvelle version vous permet    ‚îÇ
‚îÇ  de cr√©er des templates personnalis√©s  ‚îÇ
‚îÇ  pour vos listings de documents.       ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  Voulez-vous :                         ‚îÇ
‚îÇ  ‚óã Partir d'un template par d√©faut    ‚îÇ
‚îÇ  ‚óã Cr√©er un template personnalis√©     ‚îÇ
‚îÇ  ‚óã Importer un template existant      ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ         [Suivant]    [Passer]          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### √âtape 2 : Choix du template (si option 1)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Choisissez un template de d√©part :    ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  ‚óã BET Structure (recommand√©)          ‚îÇ
‚îÇ    9 champs | Affaire, Phase, Lot...  ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  ‚óã Simple                              ‚îÇ
‚îÇ    6 champs | Configuration minimale  ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  ‚óã Architecture                        ‚îÇ
‚îÇ    8 champs | Avec √âtage et Zone      ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  ‚óã Vierge                              ‚îÇ
‚îÇ    3 champs | √Ä personnaliser          ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ    [Retour]    [Suivant]    [Passer]   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### √âtape 3 : Personnalisation (optionnelle)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Personnalisez votre template :        ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  Nom : [Mon Template BET Structure]    ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  Voulez-vous modifier les champs ?     ‚îÇ
‚îÇ  ‚óã Non, utiliser tel quel              ‚îÇ
‚îÇ  ‚óã Oui, ouvrir l'√©diteur               ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  [Pr√©visualiser]                       ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ    [Retour]    [Terminer]              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### √âtape 4 : Confirmation
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚úì Votre template est pr√™t !           ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  Nom : Mon Template BET Structure      ‚îÇ
‚îÇ  Champs : 9                            ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  Vous pouvez maintenant :              ‚îÇ
‚îÇ  ‚Ä¢ Commencer √† saisir des documents    ‚îÇ
‚îÇ  ‚Ä¢ Modifier ce template                ‚îÇ
‚îÇ  ‚Ä¢ Cr√©er d'autres templates            ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  ‚òê Ne plus afficher ce wizard          ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ         [Commencer]                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üì¶ Import/Export

### Export de template
**Format** : `template_nom_v1.0.0.json`
```json
{
  "type": "listx-template",
  "version": "1.0.0",
  "exportDate": "2025-10-27T10:30:00Z",
  "data": { /* contenu du template */ }
}
```

### Export de projet complet
**Format** : `projet_nom_2025-10-27.listx` (JSON)
```json
{
  "type": "listx-project",
  "version": "1.0.0",
  "exportDate": "2025-10-27T10:30:00Z",
  "template": { /* snapshot du template */ },
  "project": { /* donn√©es du projet */ }
}
```

### Interface d'import/export
```
Menu : Fichier
  ‚îú‚îÄ‚îÄ Nouveau projet
  ‚îú‚îÄ‚îÄ Ouvrir projet...
  ‚îú‚îÄ‚îÄ Enregistrer projet
  ‚îú‚îÄ‚îÄ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  ‚îú‚îÄ‚îÄ Importer
  ‚îÇ   ‚îú‚îÄ‚îÄ Template (.json)
  ‚îÇ   ‚îî‚îÄ‚îÄ Projet complet (.listx)
  ‚îú‚îÄ‚îÄ Exporter
  ‚îÇ   ‚îú‚îÄ‚îÄ Template actuel
  ‚îÇ   ‚îú‚îÄ‚îÄ Projet complet
  ‚îÇ   ‚îú‚îÄ‚îÄ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
  ‚îÇ   ‚îú‚îÄ‚îÄ PDF
  ‚îÇ   ‚îî‚îÄ‚îÄ Excel
  ‚îî‚îÄ‚îÄ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
```

---

## ‚úÖ D√©cisions valid√©es

### 1. **Navigation entre projets** ‚Üí Option B
**D√©cision** : Bouton "Changer de projet" en haut √† gauche qui ouvre une modal de s√©lection

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ [üîÑ Projet] H√¥pital St-Jean     ‚îÇ ‚Üê Clic ‚Üí Modal
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Formulaire...                   ‚îÇ
```

**Avantages** :
- ‚úÖ Interface propre et non encombr√©e
- ‚úÖ Un seul projet actif √† la fois (simplicit√©)
- ‚úÖ Modal permet d'afficher les projets r√©cents

### 2. **Projets r√©cents**
- ‚úÖ Liste des 5 derniers projets ouverts
- ‚úÖ Acc√®s rapide dans la modal de s√©lection
- ‚úÖ Stockage dans `AppData/ListX/recents.json`

### 3. **Validation des champs** ‚Üí Simplifi√©e
**D√©cision** : Validation minimale pour v1, ajustements futurs selon besoin

**Text** :
- ‚úÖ Longueur max : 100 caract√®res
- ‚úÖ Transformation automatique : uppercase + trim
- ‚è≥ Regex optionnelle : Phase 2

**Select** :
- ‚úÖ Minimum 2 options, maximum 20 options
- ‚úÖ Valeur par d√©faut optionnelle

**Number / Date** :
- ‚è≥ Validation basique uniquement (type natif HTML)
- ‚è≥ Validations avanc√©es : Phase 2

### 4. **Gestion des doublons de champs**
**D√©cision** :
- ‚úÖ IDs uniques en interne (UUID)
- ‚úÖ Warning si noms similaires
- ‚ö†Ô∏è Interdiction stricte des noms identiques

### 5. **Nomenclature des fichiers** ‚Üí Option C
**D√©cision** : Checkbox "Inclure dans nom fichier" sur chaque champ

```
Configuration du champ :
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Nom : [Affaire___________]        ‚îÇ
‚îÇ Type : [Text ‚ñº]                   ‚îÇ
‚îÇ ‚òë Obligatoire                     ‚îÇ
‚îÇ ‚òë Inclure dans nom de fichier     ‚îÇ ‚Üê NOUVEAU
‚îÇ ‚òë Visible dans exports            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**G√©n√©ration du nom** : Concat√©nation des champs coch√©s, dans l'ordre du template
- Exemple : `HSJ_PRO_PLN_1.01_A3_A - Plan de coffrage`

### 6. **Cat√©gorisation des documents** ‚Üí Par Nature uniquement
**D√©cision** : Cat√©gorie = Champ "Nature" uniquement

**Justification** :
- ‚úÖ Simple et pr√©visible
- ‚úÖ Correspond au besoin m√©tier actuel
- ‚úÖ √âvite de cr√©er trop de cat√©gories
- ‚ö†Ô∏è Si besoin d'√©volution ‚Üí Phase 2

**Impl√©mentation** :
- Le champ marqu√© comme "Cl√© de cat√©gorie" dans le template d√©termine la cat√©gorisation
- Par d√©faut : champ nomm√© "Nature"
- Fallback : Premier champ de type `select` si "Nature" absent

### 7. **Portabilit√© inter-√©quipes** ‚Üí Logos inclus
**D√©cision** : Inclure les logos en base64 dans les exports de projets

**Format d'export** :
```json
{
  "type": "listx-project",
  "version": "1.1.0",
  "exportDate": "2025-10-27T10:30:00Z",
  "template": { /* snapshot complet du template */ },
  "project": {
    /* ... */
    "exportConfig": {
      "logoClient": "data:image/png;base64,iVBORw0KGgo...",
      "logoBE": "data:image/png;base64,iVBORw0KGgo..."
    }
  }
}
```

**Avantages** :
- ‚úÖ Fichiers autonomes (pas de d√©pendances)
- ‚úÖ Partage simplifi√© entre √©quipes
- ‚ö†Ô∏è Taille fichier : +50-200 KB (acceptable)

---

## üîÆ Fonctionnalit√©s futures (Phase 2)

### Templates favoris
- Marquer des templates comme favoris
- Affichage prioritaire dans la modal
- Ic√¥ne ‚≠ê dans la liste

### Champs calcul√©s / automatiques
- Type sp√©cial `computed`
- Formules de calcul configurables
- Exemples : `numero`, `nomComplet`, `dateCreation`

### Validations avanc√©es
- Regex personnalis√©es pour champs text
- Plages de dates min/max
- Min/Max pour champs number
- Unit√©s pour les nombres (mm, ‚Ç¨, etc.)

### Cat√©gorisation avanc√©e
- Cat√©gorie par combinaison de plusieurs champs
- Configuration : `categorieConfig: { champs: ['phase', 'nature'] }`

### R√©organisation des documents
- Note : Aucun impact lors du changement d'ordre des champs car :
  - Documents stockent les valeurs par `field_id`
  - Ordre d√©fini par `template.champs[].ordre`
  - Affichage dynamique √† chaque chargement

---

## üö® Risques et points d'attention

### Performance
- **Limite 12 champs** : Suffisant pour v1
- Templates lourds ‚Üí Parsing JSON peut ralentir
- **Mitigation** : Cache en m√©moire, lazy loading

### UX
- Ne pas perdre l'utilisateur dans la config
- Pr√©server la simplicit√© de l'app actuelle
- **Mitigation** : Wizard + templates par d√©faut

### Compatibilit√©
- Versionning des formats de fichiers
- D√©tection de version √† l'import
- **Mitigation** : Champ `version` dans tous les JSON

### Donn√©es
- Perte de donn√©es si mauvaise manipulation
- **Mitigation** :
  - Backups automatiques avant modif
  - Confirmation avant suppression
  - Snapshotting du template dans les projets

---

## üìù D√©cisions finalis√©es

### ‚úÖ Toutes les d√©cisions sont prises !
1. ‚úÖ Stockage : JSON local
2. ‚úÖ Types de champs : text, select, number, date
3. ‚úÖ Migration : Non (v1)
4. ‚úÖ Limite : 12 champs
5. ‚úÖ Interface : Modal de s√©lection (pas de wizard complexe)
6. ‚úÖ Navigation entre projets : **Option B** (Bouton + Modal)
7. ‚úÖ Validation des champs : **Simplifi√©e** (essentiel uniquement)
8. ‚úÖ Nomenclature fichiers : **Option C** (Checkbox par champ)
9. ‚úÖ Cat√©gorisation : **Par Nature uniquement**
10. ‚úÖ Logos dans export : **Oui** (inclus en base64)

### ‚úÖ Pr√™t pour Sprint 1
- [x] Structure JSON des templates valid√©e
- [x] Structure JSON des projets valid√©e
- [x] Arborescence des fichiers d√©finie
- [x] Toutes les options architecturales choisies
- [x] Interface simplifi√©e (modal au lieu de wizard complexe)

---

## üìö Ressources

### Documentation technique
- [Electron IPC](https://www.electronjs.org/docs/latest/api/ipc-main)
- [React Hooks](https://react.dev/reference/react)
- [jsPDF API](https://github.com/parallax/jsPDF)
- [ExcelJS API](https://github.com/exceljs/exceljs)

### Biblioth√®ques potentielles
- `uuid` : G√©n√©ration d'identifiants uniques
- `joi` ou `yup` : Validation de sch√©mas
- `react-beautiful-dnd` : Drag & drop pour r√©organisation
- `react-hook-form` : Gestion de formulaires dynamiques

---

**Derni√®re mise √† jour** : 2025-10-27
**Version du document** : 1.2.0
**Statut** : ‚úÖ Sprint 1 termin√© - Pr√™t pour Sprint 2 (√âditeur de templates)
